Привет, Александр!

Вижу, что ты выполнил большую работу, но остались нерешенные моменты:

1. В функции find_appointment_by_comment (строка 56) используется LIMIT 1, хотя нужно возвращать все совпадения

2. Функции поиска записей (строки 41-42 и 55-58) не возвращают человекочитаемые имена мастеров и названия услуг - требуются JOIN запросы 

3. Отсутствуют проверки перед обращением к индексам в строках 75 (master_id[0][0]) и 86 (service_id[0][0])

Твой код хорошо структурирован и использует параметризованные запросы. Внеси указанные корректировки, и получится отличное решение! 