---
project: "[[–ê–∫–∞–¥–µ–º–∏—è TOP]]"
journal: "[[PYTHON413]]"
tags:
  - PYTHON413
date: 2025-01-18
type:
  - home work
hw_num: 21
topic: –í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –≤—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–µ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –∑–∞–¥–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —Å–∂–∏–º–∞—Ç—å –∏—Ö –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ. –í—ã –Ω–∞—É—á–∏—Ç–µ—Å—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.
hw_theme:
  - python
  - pillow
  - pillow-avif
  - pillow-heif
  - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
st_group: python 413
links:
---
# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ üìÉ
**–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π v2.0**

## –ö—Ä–∞—Ç–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
–í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –≤—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–µ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –∑–∞–¥–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —Å–∂–∏–º–∞—Ç—å –∏—Ö –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ. –í—ã –Ω–∞—É—á–∏—Ç–µ—Å—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: ü¶æ
- Python
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏: Pillow, pillow-heif, pillow-avif

## –ó–∞–¥–∞–Ω–∏–µ üë∑‚Äç‚ôÇÔ∏è

### –§—É–Ω–∫—Ü–∏–∏ –∏ –∏—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

1. **get_images_paths**
   - –í—Ö–æ–¥: `source_path: str` (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
   - –í—ã—Ö–æ–¥: `list[str]` (—Å–ø–∏—Å–æ–∫ –ø—É—Ç–µ–π –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º)
   - –ó–∞–¥–∞—á–∞: —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –æ–±—Ö–æ–¥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
   - –ü—Ä–æ–≤–µ—Ä–∫–∏: —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø—É—Ç–∏, –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ALLOWED_EXTENSIONS`).

2. **compress_image**
   - –í—Ö–æ–¥: 
     - `image_path: str` (–ø—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é)
     - `output_format: str = 'AVIF'` (—Ñ–æ—Ä–º–∞—Ç —Å–∂–∞—Ç–∏—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é)
     - `quality: int = 40` (–∫–∞—á–µ—Å—Ç–≤–æ —Å–∂–∞—Ç–∏—è)
   - –í—ã—Ö–æ–¥: `str` (–ø—É—Ç—å –∫ —Å–∂–∞—Ç–æ–º—É —Ñ–∞–π–ª—É)
   - –ó–∞–¥–∞—á–∞: —Å–∂–∞—Ç–∏–µ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –µ–≥–æ.

3. **main**
   - –í—Ö–æ–¥: –Ω–µ—Ç
   - –í—ã—Ö–æ–¥: `None`
   - –ó–∞–¥–∞—á–∞: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–º –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –≤–∫–ª—é—á–∞—è –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –≤—ã–≤–æ–¥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
- `ALLOWED_EXTENSIONS = {'jpg', 'jpeg', 'png', 'JPG', 'JPEG'}`
- `DEFAULT_QUALITY = 40`
- `DEFAULT_FORMAT = 'AVIF'`
- `AVAILABLE_FORMATS = {'WEBP', 'HEIF', 'AVIF'}`

>[!info]
>### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
>- `Pillow>=10.0.0`
>- `pillow-heif>=0.13.0`
>- `pillow-avif>=1.3.1`

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–∫–∞–∑–∞–Ω–∏—è
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
- –ü–æ–¥—Å—á–∏—Ç–∞–π—Ç–µ –ø—Ä–æ—Ü–µ–Ω—Ç —Å–∂–∞—Ç–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –≤—ã–≤–µ–¥–∏—Ç–µ –µ–≥–æ –≤ –∫–æ–Ω—Å–æ–ª—å.

### –¢–∞–±–ª–∏—Ü–∞ —Ñ—É–Ω–∫—Ü–∏–π

| –§—É–Ω–∫—Ü–∏—è          | –û–ø–∏—Å–∞–Ω–∏–µ                                                   | –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã                             | –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ        |
| ---------------- | ---------------------------------------------------------- | --------------------------------------------- | ---------------------- |
| `get_images_paths` | –ü–æ–ª—É—á–∞–µ—Ç –ø—É—Ç–∏ –∫–æ –≤—Å–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.           | `source_path: str`                            | `list[str]`            |
| `compress_image` | –°–∂–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ.    | `image_path: str`, `output_format: str`, `quality: int` | `str`                  |
| `main`           | –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤—ã–≤–æ–¥–æ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞. | -                                             | `None`                 |

>[!warning]
>### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ üëå
>1. –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–µ–π —Ç–∏–ø–æ–≤
>2. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–∞–∂–¥—É—é —Ñ—É–Ω–∫—Ü–∏—é, –æ–ø–∏—Å—ã–≤–∞—è –µ—ë –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
>3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–æ–∫.
>4. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
>5. –°–æ–±–ª—é–¥–∞–π—Ç–µ PEP 8 –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∫–æ–¥–∞.
>6. –†–∞–±–æ—Ç–∞ —Å–¥–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ –∞—Ä—Ö–∏–≤–∞ —Å –∫–æ–¥–æ–º. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –µ–≥–æ –Ω–∞ —Å–∞–π—Ç–µ –ê–∫–∞–¥–µ–º–∏–∏. –í –∞—Ä—Ö–∏–≤–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ñ–∞–π–ª requirements.txt, –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∞ —Ç–∞–∫ –∂–µ txt –¥–æ–∫—É–º–µ–Ω—Ç –≥–¥–µ —Å—Å—ã–ª–∫–∞ –Ω–∞ Github.
>7. –ù–∞ GitHub –Ω–µ –º–µ–Ω–µ–µ 3 –∫–æ–º–º–∏—Ç–æ–≤. –ü—Ä–µ—Ñ–∏–∫—Å hw_21: –∏ –¥–∞–ª–µ–µ —á—Ç–æ —Å–¥–µ–ª–∞–ª–∏ –≤ —ç—Ç–æ–º –∫–æ–º–º–∏—Ç–µ.

---
## –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ (—Å–∫—Ä–∏–ø—Ç)

### –û–±—Ö–æ–¥ –û–°

```python
# –ü—Ä–∏–º–µ—Ä 1: –û–±—Ö–æ–¥ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
import os

source_path = r"C:\Images"  # –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

# –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ—Å—Ç–æ–π –æ–±—Ö–æ–¥ —á–µ—Ä–µ–∑ listdir
files = os.listdir(source_path)  # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
for file in files:
    full_path = os.path.join(source_path, file)  # –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –ø—É—Ç—å
    if os.path.isfile(full_path):  # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —ç—Ç–æ —Ñ–∞–π–ª
        print(f"–ù–∞–π–¥–µ–Ω —Ñ–∞–π–ª: {full_path}")

# –í–∞—Ä–∏–∞–Ω—Ç 2: –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –æ–±—Ö–æ–¥ —á–µ—Ä–µ–∑ walk
for root, dirs, files in os.walk(source_path):  # root - —Ç–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è, dirs - –ø–∞–ø–∫–∏, files - —Ñ–∞–π–ª—ã
    for file in files:
        full_path = os.path.join(root, file)  # –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –ø—É—Ç—å
        print(f"–ù–∞–π–¥–µ–Ω —Ñ–∞–π–ª: {full_path}")

```

### –°–∂–∞—Ç–∏–µ
```python
from PIL import Image
from pillow_heif import register_heif_opener, from_pillow as heif_from_pillow
from pillow_avif import register_avif_opener, from_pillow as avif_from_pillow

# –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —Ñ–æ—Ä–º–∞—Ç—ã
register_heif_opener()
register_avif_opener()

# –ò—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
source_image = Image.open("input.jpg")

# –°–∂–∞—Ç–∏–µ –≤ WEBP
source_image.save(
    "output.webp", 
    format="WEBP", 
    quality=40
)

# –°–∂–∞—Ç–∏–µ –≤ HEIC 
heif_file = heif_from_pillow(source_image)
heif_file.save(
    "output.heic", 
    quality=40
)

# –°–∂–∞—Ç–∏–µ –≤ AVIF
avif_file = avif_from_pillow(source_image)
avif_file.save(
    "output.avif", 
    quality=40
)

```