---
project: "[[–ê–∫–∞–¥–µ–º–∏—è TOP]]"
journal: "[[PYTHON411]]"
tags:
  - PYTHON413
date: 2025-05-23
type:
  - home work
hw_num: 35
topic: –í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –≤—ã –æ–ø–∏—à–µ—Ç–µ ORM‚Äë–º–æ–¥–µ–ª–∏ –∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç–µ –µ–¥–∏–Ω—ã–π Python‚Äë—Å–∫—Ä–∏–ø—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ PeeWee, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª –ë–î, —Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—ã, –∑–∞–ø–æ–ª–Ω—è–µ—Ç –∏—Ö —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å.
hw_theme:
  - sqlite
  - CREATE
  - INSERT
  - UPDATE
  - python
  - PeeWee
st_group: python 413
links:
---
# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ üìÉ  
**PeeWee‚Äë–º–æ–¥–µ–ª–∏ –∏ —Å–∫—Ä–∏–ø—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î ¬´–ë–∞—Ä–±–µ—Ä—à–æ–ø¬ª**  

## –ö—Ä–∞—Ç–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ  
–í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –≤—ã –æ–ø–∏—à–µ—Ç–µ ORM‚Äë–º–æ–¥–µ–ª–∏ –∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç–µ –µ–¥–∏–Ω—ã–π Python‚Äë—Å–∫—Ä–∏–ø—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ PeeWee, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª –ë–î, —Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—ã, –∑–∞–ø–æ–ª–Ω—è–µ—Ç –∏—Ö —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å.

> [!info]  
> **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Python, SQLite, PeeWee ORM  

## –ó–∞–¥–∞–Ω–∏–µ üë∑‚Äç‚ôÇÔ∏è  

### 1. –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ –ø–æ–ª–µ–π  
–û–ø–∏—à–∏—Ç–µ –º–æ–¥–µ–ª–∏ PeeWee, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü–∞–º –ø—Ä–æ–µ–∫—Ç–∞ ¬´–ë–∞—Ä–±–µ—Ä—à–æ–ø¬ª. –ü–æ–ª–µ `id` –Ω–µ –æ–±—ä—è–≤–ª—è–π—Ç–µ —è–≤–Ω–æ ‚Äî PeeWee –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –ø–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏ `AutoField`. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è —É–∫–∞–∂–∏—Ç–µ —Ç–∏–ø PeeWee –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

| –ú–æ–¥–µ–ª—å                 | –ü–æ–ª–µ         | –¢–∏–ø PeeWee                     | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã                            |
| ---------------------- | ------------ | ------------------------------ | ------------------------------------ |
| **Master**             | first_name   | `CharField`                    | `max_length=50`, `null=False`        |
|                        | last_name    | `CharField`                    | `max_length=50`, `null=False`        |
|                        | middle_name  | `CharField`                    | `max_length=50`, `null=True`         |
|                        | phone        | `CharField`                    | `max_length=20`, `unique=True`       |
| **Service**            | title        | `CharField`                    | `max_length=100`, `unique=True`      |
|                        | description  | `TextField`                    | `null=True`                          |
|                        | price        | `DecimalField`                 | `max_digits=7`, `decimal_places=2`   |
| **Appointment**        | client_name  | `CharField`                    | `max_length=100`, `null=False`       |
|                        | client_phone | `CharField`                    | `max_length=20`, `null=False`        |
|                        | date         | `DateTimeField`                | `default=datetime.now`               |
|                        | master       | `ForeignKeyField[Master]`      | `backref='appointments'`             |
|                        | status       | `CharField`                    | `max_length=20`, `default='pending'` |
| **MasterService**      | master       | `ForeignKeyField[Master]`      |                                      |
|                        | service      | `ForeignKeyField[Service]`     |                                      |
| **AppointmentService** | appointment  | `ForeignKeyField[Appointment]` |                                      |
|                        | service      | `ForeignKeyField[Service]`     |                                      |

–¢–∞–±–ª–∏—Ü–∞ –º–µ—Ç–æ–¥–æ–≤ –∏ —Ñ—É–Ω–∫—Ü–∏–π PeeWee, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –≤ —ç—Ç–æ–º –î–ó:

|–ú–µ—Ç–æ–¥ / –§—É–Ω–∫—Ü–∏—è|–û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|
|`DB.connect()`|–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.|
|`DB.create_tables([Model1, Model2, ‚Ä¶])`|–°–æ–∑–¥–∞—ë—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (—Ç–∞–±–ª–∏—Ü—ã) –≤ –ë–î, –µ—Å–ª–∏ –∏—Ö –µ—â—ë –Ω–µ—Ç.|
|`DB.close()`|–ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –ø–æ—Å–ª–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.|
|`Model.create(**fields)`|–°–æ–∑–¥–∞—ë—Ç –∏ —Å—Ä–∞–∑—É —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î –æ–¥–Ω—É –∑–∞–ø–∏—Å—å —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ–ª–µ–π.|
|`Model.insert_many(list_of_dicts).execute()`|–ü–∞–∫–µ—Ç–Ω–æ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ä–∞–∑—É 2‚Äì3 –º–∞—Å—Ç–µ—Ä–æ–≤ –∏–ª–∏ 3‚Äì4 —É—Å–ª—É–≥).|
|`Model.select()`|–ù–∞—á–∏–Ω–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–±–æ—Ä–∫—É –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.|
|`Model.select().where(condition)`|–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–ø–∏—Å–∏, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏–µ —É—Å–ª–æ–≤–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Master.select().where(Master.phone=='123')`).|
|`Model.get(condition)`|–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–æ–≤–Ω–æ –æ–¥–Ω—É –∑–∞–ø–∏—Å—å –ø–æ —É—Å–ª–æ–≤–∏—é –∏–ª–∏ –±—Ä–æ—Å–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–∏ –æ–¥–Ω–æ–π –∏–ª–∏ –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.|
|`Model.update(**fields).where(condition).execute()`|–û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –ø–æ —É—Å–ª–æ–≤–∏—é.|
|`Model.delete().where(condition).execute()`|–£–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É —É—Å–ª–æ–≤–∏—é.|
|`model_instance.save()`|–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ –º–æ–¥–µ–ª–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∫–∏ –ø–æ—Å–ª–µ `get()`).|
|`Model.select().join(OtherModel)`|–í—ã–ø–æ–ª–Ω—è–µ—Ç SQL‚ÄëJOIN —Å –¥—Ä—É–≥–æ–π –º–æ–¥–µ–ª—å—é, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ ForeignKeyField –∑–∞–ø–∏—Å–∏.|
|`ForeignKeyField(backref='‚Ä¶')`|–ü—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ —Å–æ–∑–¥–∞—ë—Ç —É–¥–æ–±–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç –≤ —Å–≤—è–∑–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `master.appointments` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º –∑–∞–ø–∏—Å—è–º —ç—Ç–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞).|
|`Model.get_or_create(**fields)`|–ò—â–µ—Ç –∑–∞–ø–∏—Å—å –ø–æ –ø–æ–ª—è–º, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî —Å–æ–∑–¥–∞—ë—Ç –µ—ë; –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ `(instance, created_flag)`.|
|`Model.count()`|–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ –∑–∞–ø–∏—Å–µ–π, –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø–æ–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞.|


### 2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞  
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `homework_35.py`, –≤ –∫–æ—Ç–æ—Ä–æ–º:

- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –±–∞–∑—É:
  ```python
  from peewee import SqliteDatabase
  DB = SqliteDatabase('barbershop.db')
  ```

- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –º–æ–¥–µ–ª–∏ —ç—Ç–æ–π –ë–î:
  ```python
  # –ü—Ä–∏–º–µ—Ä:
  # DB.connect()
  # DB.create_tables([Master, Service, Appointment, MasterService, AppointmentService])
  ```

- –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ ORM:
  - –Ω–µ –º–µ–Ω–µ–µ 2‚Äì3 –º–∞—Å—Ç–µ—Ä–æ–≤;
  - –Ω–µ –º–µ–Ω–µ–µ 3‚Äì4 —É—Å–ª—É–≥;
  - –Ω–µ –º–µ–Ω–µ–µ 3 –∑–∞—è–≤–æ–∫, –∫–∞–∂–¥–∞—è –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –æ–¥–Ω–æ–º—É –º–∞—Å—Ç–µ—Ä—É –∏ —Ä–æ–≤–Ω–æ –¥–≤—É–º —É—Å–ª—É–≥–∞–º.

- –ü–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ —Å–¥–µ–ª–∞–π—Ç–µ –≤—ã–±–æ—Ä–∫—É –∏ –≤—ã–≤–µ–¥–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å:
  ```python
  # –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
  # for m in Master.select(): ...
  # for s in Service.select(): ...
  # for a in Appointment.select(): ...
  ```

---

> [!warning]  
> ### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ üëå  
> 1. –í—Å–µ –º–æ–¥–µ–ª–∏ –æ–ø–∏—Å–∞–Ω—ã —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, `id` –Ω–µ –æ–±—ä—è–≤–ª—è–µ—Ç—Å—è —è–≤–Ω–æ.  
> 2. –°–≤—è–∑–∏ ¬´–º–Ω–æ–≥–∏–µ‚Äë–∫–æ‚Äë–º–Ω–æ–≥–∏–º¬ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ `MasterService` –∏ `AppointmentService`.  
> 3. –°–∫—Ä–∏–ø—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ (`python homework_35.py`) —Å–æ–∑–¥–∞—ë—Ç –∏–ª–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ `barbershop.db`, —Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—ã –∏ –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –∏—Ö —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –±–µ–∑ –æ—à–∏–±–æ–∫.  
> 4. –í –±–∞–∑–µ –µ—Å—Ç—å –º–∏–Ω–∏–º—É–º 2‚Äì3 –º–∞—Å—Ç–µ—Ä–∞, 3‚Äì4 —É—Å–ª—É–≥–∏ –∏ ‚â•3 –∑–∞—è–≤–æ–∫, –∫–∞–∂–¥–∞—è —Å –¥–≤—É–º—è —É—Å–ª—É–≥–∞–º–∏.  
> 5. –í –∫–æ–Ω—Å–æ–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –º–∞—Å—Ç–µ—Ä–æ–≤, —É—Å–ª—É–≥ –∏ –∑–∞—è–≤–æ–∫ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —É—Å–ª—É–≥.  
> 6. –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç PEP‚Äë8, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –∏ –º–µ—Ç–æ–¥—ã PeeWee –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.  

---

**–ß—Ç–æ —Å–¥–∞–≤–∞—Ç—å:**  
- Python‚Äë—Å–∫—Ä–∏–ø—Ç `homework_15.py`  
- –§–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö `barbershop.db`  

–ó–∞–ø—É—Å—Ç–∏—Ç–µ `python homework_15.py` ‚Äî –≤—Å—ë –¥–æ–ª–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Ç—å—Å—è, –Ω–∞–ø–æ–ª–Ω–∏—Ç—å—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏.